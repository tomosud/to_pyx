# 現在の実装仕様

**更新条件**: ゲームシステム・バランス・技術アーキテクチャの実装変更時

**最終更新**: 2025-06-22  
**フェーズ**: フェーズ4 - リッチ表現システム（実装中）  
**ルール**: このファイルは現在の実装に基づく最新仕様のみを記載します

## システム概要

日本語文字（テ、ト、リ、ス）を使ったテトリス風パズルゲーム。文字の隣接配置による連鎖システムが特徴。

### 基本ゲームフロー
1. **ブロック生成**: ランダムに文字ブロック（テ、ト、リ、ス）が上部から落下
2. **プレイヤー操作**: 矢印キーで移動、Zキーで回転、下矢印で高速落下
3. **連鎖判定**: 配置後に「テトリス」の文字が隣接しているかチェック
4. **爆発処理**: 連鎖があれば爆発エフェクトでブロック除去
5. **ゲーム継続**: スコア加算してゲーム継続、画面満杯でゲームオーバー

### 主要モジュール

1. **tet_gameB.py**: ゲーム本体（約400行）
2. **index.html**: Web版実行用HTMLファイル

### 設定ファイル・定数

1. **画面サイズ**: 160x120ピクセル
2. **プレイエリア**: 10x20グリッド
3. **文字種類**: テ、ト、リ、ス（4種類）
4. **色設定**: 各文字に固有の色（2=赤、3=緑、4=青、5=オレンジ）
5. **落下速度**: 0.5秒間隔
6. **爆発時間**: 0.6秒間のパーティクル表示

### ファイル構成詳細

- `tet_gameB.py` - メインゲームファイル（pyxel使用）
  - 文字ブロック定義（KANA_BLOCKS辞書）
  - ゲームロジック（TetrisGame クラス）
  - 連鎖判定システム（check_tetris_chain）
  - 爆発エフェクト（start_explosion）
- `index.html` - pyxel WASM版実行用

## 現在のゲームバランス

- **落下間隔**: 0.5秒 - 適度な思考時間を確保（フェーズ4でレベル制導入予定）
- **連鎖条件**: 「テトリス」4文字の隣接配置 - 戦略性とチャレンジ性のバランス
- **爆発時間**: 0.6秒 - 視覚的満足感を提供
- **ブロックサイズ**: 15x16ピクセル - 視認性と操作性を両立

## 実装中の新機能（フェーズ4）

### 音楽・効果音システム
- **BGM**: 8bit風メインテーマ（実装中）
- **効果音**: 連鎖時のチャイム音（設計中）
- **音量管理**: 設定による調整機能（計画中）

### レベルシステム
- **レベル判定**: スコア1000点ごとにレベルアップ
- **速度変化**: レベル×0.1秒の落下速度短縮
- **UI表示**: レベル・次レベルまでのスコア表示（配置検討中）

## 操作・UI仕様

### 操作方法
- **左右矢印**: ブロック移動
- **Zキー**: ブロック回転（90度単位）
- **下矢印**: 高速落下
- **Rキー**: ゲーム リスタート

### 画面表示
- **メインエリア**: 10x20のプレイフィールド
- **スコア表示**: 画面右上
- **次ブロック表示**: 画面右側
- **ゲームオーバー**: 中央にメッセージ表示

### 連鎖システム詳細
- **判定**: 配置完了時に隣接する「テ→ト→リ→ス」の順序をチェック
- **隣接**: 上下左右の4方向で判定
- **除去**: 連鎖に関わる全ブロックを除去
- **エフェクト**: パーティクル散布による視覚効果

---

**注意**: 
- この仕様は現在の実装（完成版）に基づいています
- 過去の仕様や開発経緯は `DEVELOPMENT_HISTORY.md` を参照してください